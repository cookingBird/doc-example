define(["exports","./Cartographic-67e73ef9","./Math-92c3b5f7","./PrimitiveType-e79c54d1","./GeometryAttribute-9bdde6dc"],(function(t,e,r,a,i){"use strict";var n={},o=new e.t,l=new e.t,y=new i.n,s=new a.p;function c(t,r,n,c,u,x,m,d,f,h){var z=t+r;e.t.multiplyByScalar(c,Math.cos(z),o),e.t.multiplyByScalar(n,Math.sin(z),l),e.t.add(o,l,o);var p=Math.cos(t);p*=p;var v=Math.sin(t);v*=v;var _=x/Math.sqrt(m*p+u*v)/d;return i.n.fromAxisAngle(o,_,y),a.p.fromQuaternion(y,s),a.p.multiplyByVector(s,f,h),e.t.normalize(h,h),e.t.multiplyByScalar(h,d,h),h}var u=new e.t,x=new e.t,m=new e.t,d=new e.t;n.raisePositionsToHeight=function(t,r,a){for(var i=r.ellipsoid,n=r.height,o=r.extrudedHeight,l=a?t.length/3*2:t.length/3,y=new Float64Array(3*l),s=t.length,c=a?s:0,f=0;f<s;f+=3){var h=f+1,z=f+2,p=e.t.fromArray(t,f,u);i.scaleToGeodeticSurface(p,p);var v=e.t.clone(p,x),_=i.geodeticSurfaceNormal(p,d),O=e.t.multiplyByScalar(_,n,m);e.t.add(p,O,p),a&&(e.t.multiplyByScalar(_,o,O),e.t.add(v,O,v),y[f+c]=v.x,y[h+c]=v.y,y[z+c]=v.z),y[f]=p.x,y[h]=p.y,y[z]=p.z}return y};var f=new e.t,h=new e.t,z=new e.t;n.computeEllipsePositions=function(t,a,i){var n=t.semiMinorAxis,o=t.semiMajorAxis,l=t.rotation,y=t.center,s=8*t.granularity,d=n*n,p=o*o,v=o*n,_=e.t.magnitude(y),O=e.t.normalize(y,f),P=e.t.cross(e.t.UNIT_Z,y,h);P=e.t.normalize(P,P);var w=e.t.cross(O,P,z),M=1+Math.ceil(r.e.PI_OVER_TWO/s),T=r.e.PI_OVER_TWO/(M-1),g=r.e.PI_OVER_TWO-M*T;g<0&&(M-=Math.ceil(Math.abs(g)/T));var I,A,E,V,R,W=a?new Array(3*(M*(M+2)*2)):void 0,S=0,B=u,b=x,C=4*M*3,G=C-1,H=0,N=i?new Array(C):void 0;for(B=c(g=r.e.PI_OVER_TWO,l,w,P,d,v,p,_,O,B),a&&(W[S++]=B.x,W[S++]=B.y,W[S++]=B.z),i&&(N[G--]=B.z,N[G--]=B.y,N[G--]=B.x),g=r.e.PI_OVER_TWO-T,I=1;I<M+1;++I){if(B=c(g,l,w,P,d,v,p,_,O,B),b=c(Math.PI-g,l,w,P,d,v,p,_,O,b),a){for(W[S++]=B.x,W[S++]=B.y,W[S++]=B.z,E=2*I+2,A=1;A<E-1;++A)V=A/(E-1),R=e.t.lerp(B,b,V,m),W[S++]=R.x,W[S++]=R.y,W[S++]=R.z;W[S++]=b.x,W[S++]=b.y,W[S++]=b.z}i&&(N[G--]=B.z,N[G--]=B.y,N[G--]=B.x,N[H++]=b.x,N[H++]=b.y,N[H++]=b.z),g=r.e.PI_OVER_TWO-(I+1)*T}for(I=M;I>1;--I){if(B=c(-(g=r.e.PI_OVER_TWO-(I-1)*T),l,w,P,d,v,p,_,O,B),b=c(g+Math.PI,l,w,P,d,v,p,_,O,b),a){for(W[S++]=B.x,W[S++]=B.y,W[S++]=B.z,E=2*(I-1)+2,A=1;A<E-1;++A)V=A/(E-1),R=e.t.lerp(B,b,V,m),W[S++]=R.x,W[S++]=R.y,W[S++]=R.z;W[S++]=b.x,W[S++]=b.y,W[S++]=b.z}i&&(N[G--]=B.z,N[G--]=B.y,N[G--]=B.x,N[H++]=b.x,N[H++]=b.y,N[H++]=b.z)}B=c(-(g=r.e.PI_OVER_TWO),l,w,P,d,v,p,_,O,B);var j={};return a&&(W[S++]=B.x,W[S++]=B.y,W[S++]=B.z,j.positions=W,j.numPts=M),i&&(N[G--]=B.z,N[G--]=B.y,N[G--]=B.x,j.outerPositions=N),j},t.C=n}));
